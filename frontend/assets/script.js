var width=900,height=900,color=d3.scaleOrdinal(d3.schemeCategory20),API_ROOT=process.env.ROOT_URL,form=d3.select("form").on("submit",function(){fetchAndDraw(this.wordInput.value,2)});function requestGraph(t,e){var n=new XMLHttpRequest,r=API_ROOT+":8081/api/",o="?word="+t+"&depth="+e;return console.log(r+o),n.open("GET",r+o,!1),n.send(),JSON.parse(n.responseText)}function draw(t){d3.select("#d3-container").append("svg").attr("width",width).attr("height",height);var e=d3.select("svg"),n=d3.forceSimulation(t.nodes).force("link",d3.forceLink().id(function(t){return t.id}).links(t.links).distance(15).strength(1)).force("charge",d3.forceManyBody().strength(-800).distanceMax(350)).force("collide",d3.forceCollide().strength(1).radius(8)).force("center",d3.forceCenter(width/2,height/2)),r=[],o=e.append("g").attr("class","links").selectAll("line").data(t.links).enter().append("line").attr("stroke-width",function(t){return 4}),c=e.selectAll(".node").data(t.nodes).enter().append("g").attr("class","node").on("click",function(t,e){r.push(d3.select(this).node()),d3.select(this).select("circle").transition().duration(750).attr("r",16).style("fill","orange")});c.append("circle").attr("r",function(t){return 6}).attr("fill",function(t){return color(t.group)}),c.append("title").text(function(t){return t.word}),c.append("text").attr("dx",12).attr("dy",".35em").text(function(t){return t.word}),n.nodes(t.nodes).on("tick",function(){o.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y}),c.attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),c.attr("transform",function(t){return"translate("+t.x+","+t.y+")"})})}function fetchAndDraw(t,e){d3.event.preventDefault();var n=requestGraph(t,e);d3.select("svg").remove(),draw(n)}fetchAndDraw("",1);